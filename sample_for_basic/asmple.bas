100 CLEAR1500,&HC000:DEFINTA-Z
110 BLOAD"BGMDRV.BIN"
120 UA=&HD000
130 DEFUSR9=UA+&H0'U=USR9(1)'START BGM DRIVER
140               'U=USR9(0)'END BGM DRIVER
150 DEFUSR1=UA+&H3'U=USR1(&HC000)'PLAY BGM (&HC000=BGM DATA)
160 DEFUSR2=UA+&H6'U=USR2(0)'STOP BGM
170 DEFUSR3=UA+&H9'U=USR3(&HC800)'PLAY SE (&HC800=SE DATA)
180 DEFUSR4=UA+&HC'U=USR4(1)'FADE OUT (WAIT=1)
190 DEFUSR5=UA+&HF'U=USR5(0)'IF U<>0 PLAYING NOW
200 '
210 A$="U=USR9(0)"+CHR$(13):KEY1,A$:PRINT A$'BGM DRIVER END
220 LA=&HC000:BLOAD"BGM02.BIN",LA
230 U=USR9(1)'BGM DRIVER START
240 U=USR1(LA)'PLAY BGM
250 A=&HC800:S1=A:GOSUB 350
260 U=USR3(S1)
270 END
280 '
290 '
300 'LOAD SE
350 READ A$,D
360 IF A$="FREQ" THEN POKE A,0:POKE A+1,D AND 255:POKE A+2,PEEK(VARPTR(A)+1):A=A+3:GOTO 350
370 IF A$="VOL"  THEN POKE A,1:POKE A+1,D!:A=A+2:GOTO 350
380 IF A$="NOISE"THEN POKE A,2:POKE A+1,D!:A=A+2:GOTO 350
390 IF A$="WAIT" THEN POKE A,3:POKE A+1,D!:A=A+2:GOTO 350
400 IF A$="END"  THEN POKE A,4:A=A+1:RETURN
410 ERROR 0:POKE A,4:A=A+1:RETURN
420 '
430 'SE
440 DATA FREQ,&H8000 :'32768=TONE OFF
450 DATA VOL,15,NOISE,&H80,WAIT,1
460 DATA VOL,14,NOISE,&H81,WAIT,1
470 DATA VOL,13,NOISE,&H82,WAIT,1
480 DATA VOL,12,NOISE,&H83,WAIT,1
490 DATA VOL,11,NOISE,&H84,WAIT,1
500 DATA VOL,10,NOISE,&H85,WAIT,1
510 DATA VOL,09,NOISE,&H86,WAIT,1
520 DATA VOL,08,NOISE,&H87,WAIT,1
530 DATA VOL,07,NOISE,&H88,WAIT,1
540 DATA VOL,06,NOISE,&H89,WAIT,1
550 DATA VOL,05,NOISE,&H8A,WAIT,1
560 DATA VOL,04,NOISE,&H8B,WAIT,1
570 DATA VOL,03,NOISE,&H8C,WAIT,1
580 DATA VOL,02,NOISE,&H8D,WAIT,1
590 DATA VOL,01,NOISE,&H8E,WAIT,1
600 DATA VOL,00,NOISE,&H8F,WAIT,1
610 DATA END,0
